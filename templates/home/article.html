{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Trang chủ</a></li>
                <li class="breadcrumb-item"><a href="{% url 'category_detail' article.category.slug %}">{{ article.category.name }}</a></li>
                <li class="breadcrumb-item active" aria-current="page">{{ article.name }}</li>
            </ol>
        </nav>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <!-- Article Content -->
        <article>
            <header class="mb-4">
                <h1 class="fw-bold">{{ article.name }}</h1>
                <div class="text-muted mb-2">
                    <i class="fas fa-calendar-alt"></i> {{ article.publish_date|date:"d/m/Y H:i" }}
                    <span class="mx-2">|</span>
                    <i class="fas fa-folder"></i> <a href="{% url 'category_detail' article.category.slug %}" class="text-decoration-none">{{ article.category.name }}</a>
                </div>
                {% if article.special %}
                    <span class="badge bg-danger mb-3">Tin nổi bật</span>
                {% endif %}
            </header>

            {% if article.image %}
                <figure class="mb-4">
                    <img class="img-fluid rounded" src="{{ article.image.url }}" alt="{{ article.name }}">
                </figure>
            {% endif %}

            <section class="article-content mb-5">
                {{ article.content|safe }}
            </section>
        </article>

        <!-- Social Share Buttons -->
        <div class="mb-5">
            <h5>Chia sẻ bài viết:</h5>
            <div class="d-flex gap-2">
                <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="btn btn-sm btn-primary">
                    <i class="fab fa-facebook-f"></i> Facebook
                </a>
                <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ article.name }}" target="_blank" class="btn btn-sm btn-info text-white">
                    <i class="fab fa-twitter"></i> Twitter
                </a>
                <a href="https://t.me/share/url?url={{ request.build_absolute_uri }}&text={{ article.name }}" target="_blank" class="btn btn-sm btn-primary">
                    <i class="fab fa-telegram"></i> Telegram
                </a>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <!-- Related Articles -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Bài viết liên quan</h5>
            </div>
            <div class="card-body p-0">
                <ul class="list-group list-group-flush">
                    {% for related in related_articles %}
                        <li class="list-group-item">
                            {% if related.image %}
                                <div class="row g-0">
                                    <div class="col-4">
                                        <img src="{{ related.image.url }}" class="img-fluid rounded" alt="{{ related.name }}">
                                    </div>
                                    <div class="col-8 ps-3">
                                        <a href="{% url 'article_detail' related.slug %}" class="text-decoration-none">
                                            {{ related.name }}
                                        </a>
                                        <div class="small text-muted mt-1">
                                            <i class="fas fa-calendar-alt"></i> {{ related.publish_date|date:"d/m/Y" }}
                                        </div>
                                    </div>
                                </div>
                            {% else %}
                                <a href="{% url 'article_detail' related.slug %}" class="text-decoration-none">
                                    {{ related.name }}
                                </a>
                                <div class="small text-muted mt-1">
                                    <i class="fas fa-calendar-alt"></i> {{ related.publish_date|date:"d/m/Y" }}
                                </div>
                            {% endif %}
                        </li>
                    {% empty %}
                        <li class="list-group-item">Không có bài viết liên quan.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Categories -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Danh mục</h5>
            </div>
            <div class="card-body p-0">
                <ul class="list-group list-group-flush">
                    {% for cat in categories %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <a href="{% url 'category_detail' cat.slug %}" class="text-decoration-none">
                                {{ cat.name }}
                            </a>
                            <span class="badge bg-primary rounded-pill">{{ cat.articles.count }}</span>
                        </li>
                    {% empty %}
                        <li class="list-group-item">Không có danh mục nào.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}